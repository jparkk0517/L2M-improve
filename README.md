# L2M-improve

빅데이터와 정보검색 기말고사를 위한 L2M-DV 모델 제안 및 실험

## baseline vs CoT vs L2M vs L2M-DV

| 항목         | 조건    |
| ------------ | ------- |
| batch size   | 20      |
| LLM Model    | gpt-4o  |
| words number | 1 -> 15 |

# 실험 (last-letter-concatenation task)

![alt text](experiments/20251216_164827/accuracy_comparison.png)

## 항목 설명

### Accuracy

위치별(position-wise) 정확도. 각 글자 위치에서 정답과 일치하는지 비교.

### Micro Accuracy

전체 prediction에서 맞춘 글자 수의 총합 / 전체 gold 글자 수의 총합
(글자 수가 많은 문제에 더 큰 가중치)

### Macro Accuracy

각 문제별 정확도의 평균
(모든 문제에 동일한 가중치)

### Batch Summary (n_words=15)

| Strategy | Accuracy | Tokens | Avg Time |
| -------- | -------- | ------ | -------- |
| Baseline | 43.67%   | 7,895  | 1.261s   |
| CoT      | 41.00%   | 8,292  | 1.233s   |
| L2M      | 57.00%   | 12,703 | 2.884s   |
| L2M-DV   | 72.67%   | 17,357 | 4.062s   |

### Average position-wise accuracy

| Strategy | Macro / Micro   | Exact Match |
| -------- | --------------- | ----------- |
| Baseline | 56.21% / 50.25% | EM: 11.33%  |
| CoT      | 56.45% / 50.21% | EM: 11.33%  |
| L2M      | 82.55% / 75.29% | EM: 50.00%  |
| L2M-DV   | 91.19% / 87.46% | EM: 63.67%  |

### Token Usage & Time

| Strategy | Token Usage (Total) | Average Time (sec) |
| -------- | ------------------- | ------------------ |
| Baseline | 110,111 tokens      | 1.064s             |
| CoT      | 117,398 tokens      | 1.068s             |
| L2M      | 169,496 tokens      | 2.181s             |
| L2M-DV   | 239,966 tokens      | 3.443s             |

### Position-wise Accuracy by Number of Words (%)

| n_words | Baseline | CoT    | L2M    | L2M-DV |
| ------- | -------- | ------ | ------ | ------ |
| 1       | 100.00   | 100.00 | 100.00 | 100.00 |
| 2       | 67.50    | 70.00  | 100.00 | 95.00  |
| 3       | 60.00    | 60.00  | 100.00 | 100.00 |
| 4       | 60.00    | 57.50  | 95.00  | 97.50  |
| 5       | 54.00    | 60.00  | 89.00  | 95.00  |
| 6       | 60.83    | 58.33  | 88.33  | 96.67  |
| 7       | 57.14    | 55.00  | 88.57  | 97.14  |
| 8       | 54.37    | 60.00  | 95.00  | 92.50  |
| 9       | 51.11    | 52.22  | 73.89  | 91.67  |
| 10      | 52.50    | 51.00  | 77.00  | 92.50  |
| 11      | 49.09    | 49.55  | 75.45  | 87.27  |
| 12      | 47.50    | 44.58  | 70.42  | 89.58  |
| 13      | 40.00    | 41.92  | 65.38  | 80.00  |
| 14      | 45.36    | 45.71  | 63.21  | 80.36  |
| 15      | 43.67    | 41.00  | 57.00  | 72.67  |

### 종합 분석

| 항목    | Baseline | CoT     | L2M     | L2M-DV  |
| ------- | -------- | ------- | ------- | ------- |
| Micro   | 50.25    | 50.21   | 75.29   | 87.46   |
| Macro   | 56.21    | 56.45   | 82.55   | 91.19   |
| EM      | 11.33    | 11.33   | 50.00   | 63.67   |
| Tokens  | 110,111  | 117,398 | 169,496 | 239,966 |
| Time(s) | 1.064    | 1.068   | 2.181   | 3.443   |

| n_words | Metric   | Baseline | CoT     | L2M     | L2M-DV  |
| ------- | -------- | -------- | ------- | ------- | ------- |
| 1       | Accuracy | 100.00%  | 100.00% | 100.00% | 100.00% |
|         | EM       | 100.0%   | 100.0%  | 100.0%  | 100.0%  |
|         | Tokens   | 6,876    | 7,376   | 9,997   | 14,422  |
|         | Time     | 1.083s   | 1.016s  | 1.482s  | 2.467s  |
| 2       | Accuracy | 67.50%   | 70.00%  | 100.00% | 95.00%  |
|         | EM       | 40.0%    | 50.0%   | 100.0%  | 85.0%   |
|         | Tokens   | 6,919    | 7,419   | 10,245  | 14,881  |
|         | Time     | 1.139s   | 1.112s  | 1.649s  | 3.160s  |
| 3       | Accuracy | 60.00%   | 60.00%  | 100.00% | 100.00% |
|         | EM       | 10.0%    | 15.0%   | 100.0%  | 100.0%  |
|         | Tokens   | 6,996    | 7,496   | 10,369  | 14,862  |
|         | Time     | 0.932s   | 0.949s  | 1.695s  | 2.774s  |
| 4       | Accuracy | 60.00%   | 57.50%  | 95.00%  | 97.50%  |
|         | EM       | 5.0%     | 5.0%    | 75.0%   | 90.0%   |
|         | Tokens   | 7,082    | 7,561   | 10,613  | 15,337  |
|         | Time     | 0.894s   | 0.894s  | 1.984s  | 2.910s  |
| 5       | Accuracy | 54.00%   | 60.00%  | 89.00%  | 95.00%  |
|         | EM       | 0.0%     | 0.0%    | 60.0%   | 75.0%   |
|         | Tokens   | 7,131    | 7,633   | 10,753  | 15,389  |
|         | Time     | 0.827s   | 0.938s  | 1.618s  | 2.747s  |
| 6       | Accuracy | 60.83%   | 58.33%  | 88.33%  | 96.67%  |
|         | EM       | 10.0%    | 10.0%   | 55.0%   | 75.0%   |
|         | Tokens   | 7,182    | 7,683   | 10,926  | 15,610  |
|         | Time     | 0.991s   | 1.031s  | 1.903s  | 3.107s  |
| 7       | Accuracy | 57.14%   | 55.00%  | 88.57%  | 97.14%  |
|         | EM       | 5.0%     | 5.0%    | 60.0%   | 80.0%   |
|         | Tokens   | 7,294    | 7,758   | 11,072  | 15,625  |
|         | Time     | 1.091s   | 1.007s  | 2.066s  | 3.451s  |
| 8       | Accuracy | 54.37%   | 60.00%  | 95.00%  | 92.50%  |
|         | EM       | 0.0%     | 0.0%    | 75.0%   | 70.0%   |
|         | Tokens   | 7,378    | 7,824   | 11,225  | 15,863  |
|         | Time     | 0.963s   | 1.101s  | 2.153s  | 3.586s  |
| 9       | Accuracy | 51.11%   | 52.22%  | 73.89%  | 91.67%  |
|         | EM       | 0.0%     | 5.0%    | 20.0%   | 70.0%   |
|         | Tokens   | 7,380    | 7,881   | 11,496  | 16,274  |
|         | Time     | 1.108s   | 1.029s  | 2.390s  | 3.773s  |
| 10      | Accuracy | 52.50%   | 51.00%  | 77.00%  | 92.50%  |
|         | EM       | 0.0%     | 0.0%    | 40.0%   | 70.0%   |
|         | Tokens   | 7,457    | 7,960   | 11,631  | 16,412  |
|         | Time     | 1.129s   | 1.149s  | 2.473s  | 3.745s  |
| 11      | Accuracy | 49.09%   | 49.55%  | 75.45%  | 87.27%  |
|         | EM       | 0.0%     | 0.0%    | 25.0%   | 40.0%   |
|         | Tokens   | 7,526    | 8,027   | 11,721  | 16,498  |
|         | Time     | 1.171s   | 1.032s  | 2.525s  | 3.439s  |
| 12      | Accuracy | 47.50%   | 44.58%  | 70.42%  | 89.58%  |
|         | EM       | 0.0%     | 0.0%    | 25.0%   | 55.0%   |
|         | Tokens   | 7,608    | 8,108   | 12,060  | 17,155  |
|         | Time     | 1.067s   | 1.058s  | 2.584s  | 4.122s  |
| 13      | Accuracy | 40.00%   | 41.92%  | 65.38%  | 80.00%  |
|         | EM       | 0.0%     | 0.0%    | 25.0%   | 45.0%   |
|         | Tokens   | 7,683    | 8,176   | 12,322  | 16,950  |
|         | Time     | 1.119s   | 1.144s  | 2.475s  | 4.065s  |
| 14      | Accuracy | 45.36%   | 45.71%  | 63.21%  | 80.36%  |
|         | EM       | 0.0%     | 0.0%    | 10.0%   | 35.0%   |
|         | Tokens   | 7,704    | 8,204   | 12,363  | 17,331  |
|         | Time     | 1.180s   | 1.330s  | 2.831s  | 4.244s  |
| 15      | Accuracy | 43.67%   | 41.00%  | 57.00%  | 72.67%  |
|         | EM       | 0.0%     | 0.0%    | 10.0%   | 20.0%   |
|         | Tokens   | 7,895    | 8,292   | 12,703  | 17,357  |
|         | Time     | 1.261s   | 1.233s  | 2.884s  | 4.062s  |
